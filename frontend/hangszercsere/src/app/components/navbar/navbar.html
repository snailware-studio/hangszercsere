<nav class="sticky top-0 z-50 flex flex-wrap justify-between items-center px-4 border-b-2
            border-gray-300 dark:border-gray-700
            bg-light-navbar-bg text-light-text-primary dark:bg-navbar-bg dark:text-text-primary">

  <!-- Logo -->
  <a routerLink="/" class="nav-logo hidden sm:inline-block">
    Hangszercsere.hu
  </a>

  <!-- Menu items -->
  <div class="flex flex-wrap gap-2 items-center mt-2 sm:mt-0">

    <!-- Dark mode toggle -->
    <button (click)="toggleDarkMode()"
            class="relative w-12 h-6 rounded-full bg-gray-400 dark:bg-gray-600 flex items-center transition-colors">

      <span class="absolute w-5 h-5 bg-white dark:bg-gray-600 rounded-full shadow-md
                   left-0 transition-all duration-300 dark:translate-x-6"></span>

      <span class="absolute left-0.5 text-xs transition-opacity duration-300 dark:opacity-0">â˜€ï¸</span>
      <span class="absolute right-1 text-xs transition-opacity duration-300 opacity-0 dark:opacity-100">ğŸŒ™</span>
    </button>

    <!-- NOT logged in -->
    <ng-container *ngIf="!isLoggedIn()">

    <button (click)="openMenu('login')" class="nav-item">Login</button>
    <button (click)="openMenu('register')" class="nav-item">Register</button>
    </ng-container>

    <!-- Logged in -->
    <ng-container *ngIf="isLoggedIn()">

      <!-- Dropdown for username -->
      <div class="relative inline-block">
        <button (click)="dropdown = !dropdown"
                class="px-3 py-1 rounded bg-light-card-bg dark:bg-card-bg
                       text-light-text-secondary dark:text-text-secondary
                       hover:bg-accent hover:text-text-primary dark:hover:bg-accent dark:hover:text-text-primary
                       flex items-center gap-1 transition-all">
                    <img [src]="'https://hangszercsere.hu/uploads/' + userService.currentUser?.profile_url" 
                alt="" 
                class="w-8 h-8 rounded-full">
            <span>{{ userService.currentUser?.name }}</span>
          <svg class="w-4 h-4 transition-transform" [class.rotate-180]="dropdown"
               fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>

        <div class="absolute right-0 mt-1 w-40 bg-light-card-bg dark:bg-card-bg
                    rounded shadow-lg overflow-hidden transition-all z-50"
             [class.hidden]="!dropdown">


          <a (click)="GotoProfile(userService.getUserId());dropdown = !dropdown" class="dropdown-item">Profile</a>

          <a routerLink="/chat" class="dropdown-item" (click)="dropdown = !dropdown">Chats</a>

          <a (click)="LogOut();dropdown = !dropdown" class="dropdown-item">Logout</a>


        </div>
      </div>

      <a routerLink="/upload" class="nav-item">Upload</a>
      <a routerLink="/cart" class="nav-item">ğŸ›’ Cart</a>
    </ng-container>

  </div>
</nav>

<app-login
  *ngIf="menu === 'login'"
  [isMenu]="true"
  (close)="closeMenu()">
</app-login>

<app-register
  *ngIf="menu === 'register'"
  [isMenu]="true"
  (close)="closeMenu()">
</app-register>